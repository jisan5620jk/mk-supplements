{%- liquid
  assign section_id = 'services-' | append: section.id
-%}

<style>
  /* ----- Component scope ----- */
  #{{ section_id }} {
    --bg: {{ section.settings.bg | default: '#b09a78' }};
    --text: {{ section.settings.text_color | default: '#2b2b2b' }};
    --muted: color-mix(in srgb, var(--text), #666 40%);
    --card-bg: {{ section.settings.card_bg | default: '#ffffff' }};
    --accent: {{ section.settings.accent | default: '#2b2b2b' }};
    --radius: {{ section.settings.corner_radius | default: 24 }}px;
    --container: min(1200px, 90vw);
    --pad-y: clamp(40px, 6vw, 96px);
  }

  #{{ section_id }} .services__wrap {
    background: var(--bg);
    color: var(--text);
    padding-block: var(--pad-y);
  }

  #{{ section_id }} .services__container {
    width: var(--container);
    margin-inline: auto;
    position: relative;
  }

  /* Header */
  #{{ section_id }} .services__header {
    text-align: center;
    margin-bottom: clamp(24px, 3vw, 40px);
  }

  #{{ section_id }} .section-title {
    color: #fff;
  }

  #{{ section_id }} .services__subheading {
    max-width: 900px;
    margin: 0 auto;
    color: #fff;
    font-family: 'SAASERIESFDOT';
    font-weight: 400;
    font-size: 22px;
    line-height: 28px;
    text-align: center;

  }

  /* Swiper base & fallback if JS fails */
  #{{ section_id }} .swiper {
    overflow: visible; /* so arrows can sit outside */
  }

  /* Card */
  #{{ section_id }} .service-card {
    background: var(--card-bg);
    display: grid;
    grid-template-rows: auto 1fr;
    border-radius: var(--radius);
    overflow: hidden;
    box-shadow: 0 8px 20px rgba(0,0,0,.08);
    height: 100%;
  }
  #{{ section_id }} .service-card__media {
    display: block;
    aspect-ratio: {{ section.settings.image_ratio }};
    width: 100%;
    overflow: hidden;
  }
  #{{ section_id }} .service-card__media img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
  }
  #{{ section_id }} .service-card__body {
    padding: clamp(16px, 2.8vw, 28px);
  }
  #{{ section_id }} .service-card__title {
    font-family: 'SAASERIESFDOT';
    font-weight: 400;
    font-size: 26px;
    line-height: 28px;
    letter-spacing: 0%;
    text-transform: uppercase;
    margin: 0 0 10px 0;
  }
  #{{ section_id }} .service-card__text {
    color: var(--muted);
    font-size: 16px;
    line-height: 1.7;
  }

  /* Nav buttons */
  #{{ section_id }} .services__nav {
    position: absolute;
    inset: 0;
    pointer-events: none;
  }
  #{{ section_id }} .services__btn {
    pointer-events: auto;
    position: absolute;
    top: 46%;
    translate: 0 -50%;
    z-index: 2;
    width: 40px; height: 40px;
    border-radius: 50%;
    border: 0;
    background: #111;
    color: #fff;
    display: grid;
    place-items: center;
    cursor: pointer;
    transition: opacity .2s ease, transform .2s ease;
  }
  #{{ section_id }} .services__btn:hover { transform: translateY(-50%) scale(1.04); }
  #{{ section_id }} .services__btn:disabled { opacity: .35; cursor: default; }
  #{{ section_id }} .services__btn--prev { left: -14px; }
  #{{ section_id }} .services__btn--next { right: -14px; }

  /* Dots */
  #{{ section_id }} .swiper-pagination-bullets {
    position: static;
    margin-top: 18px;
    display: flex;
    justify-content: center;
    gap: 8px;
  }
  #{{ section_id }} .swiper-pagination-bullet {
    width: 8px; height: 8px;
    background: #fff;
    opacity: .4;
    transition: opacity .2s ease, transform .2s ease;
  }
  #{{ section_id }} .swiper-pagination-bullet-active {
    opacity: 1; transform: scale(1.1);
  }

  /* Responsive tweaks */
  @media (max-width: 989px) {
    #{{ section_id }} .services__btn--prev { left: 4px; }
    #{{ section_id }} .services__btn--next { right: 4px; }
  }
  @media (max-width: 749px) {
    #{{ section_id }} .services__btn { display: {% if section.settings.show_arrows %}grid{% else %}none{% endif %}; width: 36px; height: 36px; }
  }
</style>

<section
  id="{{ section_id }}"
  class="services-section {% if section.settings.enable_boxed_section %}boxed-section{% endif %}"
>
  <div class="services__wrap">
    <div class="services__container">
      {% if section.settings.heading != blank or section.settings.subheading != blank %}
        <header class="services__header">
          {% if section.settings.heading != blank %}
            <h2 class="section-title">{{ section.settings.heading | escape }}</h2>
          {% endif %}
          {% if section.settings.subheading != blank %}
            <p class="services__subheading">{{ section.settings.subheading }}</p>
          {% endif %}
        </header>
      {% endif %}

      <div
        class="swiper services-slider-{{ section_id }}"
        aria-label="{{ section.settings.a11y_label | default: 'Services slider' }}"
      >
        <div class="swiper-wrapper">
          {%- for block in section.blocks -%}
            {%- assign img = block.settings.image -%}
            <div class="swiper-slide" {{ block.shopify_attributes }}>
              <article class="service-card">
                <div class="service-card__media">
                  {% if img != blank %}
                    {{
                      img
                      | image_url: width: 1200
                      | image_tag:
                        loading: 'lazy',
                        sizes: '(min-width: 1200px) 380px, (min-width: 990px) 31vw, (min-width: 750px) 45vw, 90vw',
                        widths: '320,480,640,768,960,1200',
                        alt: block.settings.title
                      | escape
                    }}
                  {% else %}
                    {{ 'image' | placeholder_svg_tag: 'placeholder-svg' }}
                  {% endif %}
                </div>

                <div class="service-card__body">
                  {% if block.settings.title != blank %}
                    <h3 class="service-card__title">{{ block.settings.title | escape }}</h3>
                  {% endif %}

                  {% if block.settings.text != blank %}
                    <div class="service-card__text">{{ block.settings.text }}</div>
                  {% endif %}
                </div>
              </article>
            </div>
          {%- endfor -%}
        </div>

        {% if section.settings.show_dots %}
          <div class="swiper-pagination"></div>
        {% endif %}
      </div>

      {% if section.settings.show_arrows %}
        <div class="services__nav" aria-hidden="true">
          <button class="services__btn services__btn--prev" type="button">
            <svg width="18" height="18" viewBox="0 0 24 24" aria-hidden="true">
              <path d="M15 18l-6-6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </button>
          <button class="services__btn services__btn--next" type="button">
            <svg width="18" height="18" viewBox="0 0 24 24" aria-hidden="true">
              <path d="M9 6l6 6-6 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </button>
        </div>
      {% endif %}
    </div>
  </div>
</section>

<script>
  document.addEventListener('DOMContentLoaded', function () {
      const swiper = new Swiper('.services-slider-{{ section_id }}', {
          slidesPerView: {{ section.settings.slides_desktop | default: 4 }},
          spaceBetween: {{ section.settings.space_between | default: 24 }},
          loop: {{ section.settings.loop | json }},
          speed: {{ section.settings.speed | default: 600 }},
          grabCursor: {{ section.settings.grab_cursor | json }},
          centeredSlides: {{ section.settings.centered | json }},
          navigation: {{ section.settings.show_navigation | json }} ? {
          prevEl: '#prev-{{ section_id }}',
          nextEl: '#next-{{ section_id }}'
          } : undefined,
          autoplay: {{ section.settings.autoplay | json }} ? {
          delay: {{ section.settings.autoplay_delay | default: 4000 }},
          disableOnInteraction: false,
          pauseOnMouseEnter: {{ section.settings.pause_on_hover | json }}
          } : false,
          breakpoints: {
          0:   { slidesPerView: {{ section.settings.slides_mobile | default: 1 }}, spaceBetween: {{ section.settings.space_between_mobile | default: section.settings.space_between }} },
          750: { slidesPerView: {{ section.settings.slides_tablet | default: 2 }}, spaceBetween: {{ section.settings.space_between_tablet | default: section.settings.space_between }} },
          990: { slidesPerView: {{ section.settings.slides_desktop | default: 4 }}, spaceBetween: {{ section.settings.space_between | default: 24 }} }
          }
      });
  });
</script>

{% schema %}
{
  "name": "Services / Values slider",
  "tag": "section",
  "class": "section services-section",
  "settings": [
    {
      "type": "checkbox",
      "id": "enable_boxed_section",
      "label": "Enable Boxed Section",
      "default": true
    },

    { "type": "text", "id": "heading", "label": "Heading", "default": "From our homestead to your home" },
    {
      "type": "richtext",
      "id": "subheading",
      "label": "Subheading",
      "default": "<p>We’re a small, family-owned business that takes pride in delivering the highest-quality and environmentally-friendly dietary supplements.</p>"
    },

    { "type": "color", "id": "bg", "label": "Background color", "default": "#b09a78" },
    { "type": "color", "id": "text_color", "label": "Text color", "default": "#2b2b2b" },
    { "type": "color", "id": "card_bg", "label": "Card color", "default": "#ffffff" },
    { "type": "color", "id": "accent", "label": "Accent color (titles/links)", "default": "#2b2b2b" },

    { "type": "text", "id": "a11y_label", "label": "Aria label", "default": "Company services and values" },
    {
      "type": "select",
      "id": "image_ratio",
      "label": "Image ratio",
      "default": "1 / 1",
      "options": [
        { "value": "1 / 1", "label": "Square" },
        { "value": "4 / 5", "label": "Portrait" },
        { "value": "4 / 3", "label": "Landscape" }
      ]
    },

    { "type": "header", "content": "Slider settings" },
    {
      "type": "range",
      "id": "slides_desktop",
      "min": 1,
      "max": 6,
      "step": 1,
      "default": 4,
      "label": "Slides per view (desktop ≥ 990px)"
    },
    {
      "type": "range",
      "id": "slides_tablet",
      "min": 1,
      "max": 4,
      "step": 1,
      "default": 2,
      "label": "Slides per view (tablet ≥ 750px)"
    },
    {
      "type": "range",
      "id": "slides_mobile",
      "min": 1,
      "max": 3,
      "step": 1,
      "default": 1,
      "label": "Slides per view (mobile)"
    },
    {
      "type": "range",
      "id": "space_between",
      "min": 0,
      "max": 48,
      "step": 2,
      "default": 24,
      "label": "Space between slides (desktop px)"
    },
    {
      "type": "range",
      "id": "space_between_tablet",
      "min": 0,
      "max": 48,
      "step": 2,
      "default": 20,
      "label": "Space between slides (tablet px)"
    },
    {
      "type": "range",
      "id": "space_between_mobile",
      "min": 0,
      "max": 48,
      "step": 2,
      "default": 12,
      "label": "Space between slides (mobile px)"
    },
    { "type": "checkbox", "id": "autoplay", "label": "Autoplay", "default": true },
    {
      "type": "number",
      "id": "autoplay_delay",
      "default": 4000,
      "label": "Autoplay delay (ms)"
    },
    {
      "type": "number",
      "id": "speed",
      "default": 600,
      "label": "Transition speed (ms)"
    },
    { "type": "checkbox", "id": "pause_on_hover", "label": "Pause on hover", "default": false },
    { "type": "checkbox", "id": "loop", "label": "Loop slides", "default": true },
    { "type": "checkbox", "id": "grab_cursor", "label": "Grab cursor", "default": true },
    { "type": "checkbox", "id": "show_navigation", "label": "Show arrows", "default": true }
  ],
  "blocks": [
    {
      "type": "card",
      "name": "Service card",
      "settings": [
        { "type": "image_picker", "id": "image", "label": "Image" },
        { "type": "text", "id": "title", "label": "Title", "default": "Healthy living" },
        {
          "type": "richtext",
          "id": "text",
          "label": "Description",
          "default": "<p>Write a short, compelling paragraph about this value or service.</p>"
        }
      ]
    }
  ],
  "max_blocks": 12,
  "presets": [
    {
      "name": "Services / Values slider",
      "blocks": [{ "type": "card" }, { "type": "card" }, { "type": "card" }]
    }
  ]
}
{% endschema %}
